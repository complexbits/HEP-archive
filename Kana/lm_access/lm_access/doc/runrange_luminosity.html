<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>lm_access: sample_luminosity</title>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000">
<table style="width: 1000px; height: 2132px;" border="0" cellpadding="0"
 cellspacing="0">
  <tbody>
    <tr>
      <td height="2227" valign="top" width="1000">
      <h2><font face="Verdana, Arial, Helvetica, sans-serif">runrange_luminosity
function</font></h2>
      <h2>&nbsp;</h2>
      <h2><font face="Verdana, Arial, Helvetica, sans-serif">This
utility will calculate the luminosity for a set of triggers and run
ranges within a data sample and return a bad lbns list for analysis</font></h2>
      <h2>&nbsp;</h2>
      <h2><font face="Verdana, Arial, Helvetica, sans-serif">Syntax is:</font></h2>
      <p><font face="Verdana, Arial, Helvetica, sans-serif"><b>runrange_luminosity
&lt;listoffiles&gt; &lt;parentagepath&gt; &lt;runrangelist&gt;</b></font></p>
      <p><b><font face="Verdana, Arial, Helvetica, sans-serif">This
executable exists in p17 and p18 and will soon be a ups product you can
set up to get the latest official version.</font></b></p>
      <p><font face="Verdana, Arial, Helvetica, sans-serif">The
runrange list is a file in the following format:</font></p>
      <pre><font face="Verdana, Arial, Helvetica, sans-serif">EM_HI_SH 175349 178233</font></pre>
      <pre><font face="Verdana, Arial, Helvetica, sans-serif">E1_SHT20 178234 199999</font>        </pre>
      <p><font face="Verdana, Arial, Helvetica, sans-serif">........</font></p>
      <p><font face="Verdana, Arial, Helvetica, sans-serif">The program
expects any good runs list to be in goodRunsList, bad runs in
badRunsList and bad lbns be in badLBNList.</font></p>
      <p><font face="Verdana, Arial, Helvetica, sans-serif">Output is 3
files for each line in the runrange list</font></p>
      <p><font face="Verdana, Arial, Helvetica, sans-serif"><b>&lt;listoffiles&gt;_&lt;trigger&gt;_&lt;runlo&gt;-&lt;runhi&gt;.lum</b>
summary of luminosity information</font></p>
      <p><font face="Verdana, Arial, Helvetica, sans-serif"><b>recorded_&lt;listoffiles&gt;_&lt;trigger&gt;-&lt;runlo&gt;-&lt;runhi&gt;.badlbns</b>
list of bad lbns within the runrange, including the input bad runs and
lbns for recorded data</font></p>
      <p><font face="Verdana, Arial, Helvetica, sans-serif"><b>reconstructed_&lt;listoffiles&gt;_&lt;trigger&gt;.badlbns</b>
list of bad lbns within the runrange specified, including the input bad
runs and lbns for reconstructed data (includes checks on processing)</font></p>
      <p align="center"><img src="sample2.jpg" height="395" width="384"></p>
      <h2>&nbsp;</h2>
      <h2><font face="Verdana, Arial, Helvetica, sans-serif">HOW TO USE
THIS TO GET A NORMALIZED CROSS SECTION</font></h2>
      <h2>&nbsp;</h2>
      <ul>
        <li><font face="Verdana, Arial, Helvetica, sans-serif">Get your
parentage for your sample </font>
          <ul>
            <li><font face="Arial, Helvetica, sans-serif">If it is a
common skim, use the <a href="SkimParentage.html"><strong>skim
parentage instructions</strong></a> <font color="#ff0000">(fast) Don't
forget to use the correct option for the luminosity data source: stage
file or DB.<br>
              </font></font></li>
            <li><font face="Arial, Helvetica, sans-serif">If it is not
a
common skim, use the <a href="MakeParentage.html"><strong>lm_access
scripts</strong></a> to generate <font color="#ff0000">(very slow)</font></font></li>
          </ul>
        </li>
      </ul>
      <ul>
        <li><font face="Verdana, Arial, Helvetica, sans-serif">Create a
list of files for your sample -&gt; listname (this needs to be in the
directory as the name of the list will be used to make the output file
names). </font></li>
      </ul>
      <ul>
        <li><font face="Verdana, Arial, Helvetica, sans-serif">Create a
list of bad runs for your sample in <b>badRunsList</b><br>
Or a list of good runs in goodRunsList</font></li>
      </ul>
      <ul>
        <li><font face="Verdana, Arial, Helvetica, sans-serif">Create a
list of bad lbns for your sample in <b>badLBNList</b></font></li>
      </ul>
      <ul>
        <li><font face="Verdana, Arial, Helvetica, sans-serif">Run the
program </font></li>
      </ul>
      <p><font face="Verdana, Arial, Helvetica, sans-serif"><b><font
 face="Courier New, Courier, mono"> </font><font
 face="Courier New, Courier, mono">runrange_luminosity &lt;listname&gt;
&lt;parentagepath&gt; &lt;runrangelist&gt;</font></b></font></p>
      <blockquote>
        <p><font face="Verdana, Arial, Helvetica, sans-serif">It will
produce a luminosity summary and lists of bad lbns for your sample this
is the OR of bad lbns from your bad runs bad lbns and those known to be
bad in the normalization. There will be separate bad run lists for each
trigger runrange choice. Use this list in your analysis!</font></p>
      </blockquote>
      <ul>
        <li>
          <h4><font face="Verdana, Arial, Helvetica, sans-serif"><b>In
your analysis code throw out the bad lbns from all sources</b></font></h4>
        </li>
      </ul>
      <p></p>
      <blockquote>
        <p><font face="Verdana, Arial, Helvetica, sans-serif">Use the
class <b>lm_access/BadLBNList</b> <br>
        </font></p>
        <p><font face="Courier New, Courier, mono">#include
&#8220;lm_access/BadLBNList.hpp&#8221; </font></p>
        <p><font face="Courier New, Courier, mono">// initialize and
read in the badLBNList from runrange_luminosity<br>
lm_access::BadLBNList* pbadlbnlistEM_HI_SH = new
lm_access::BadLBNList();<br>
lm_access::BadLBNList* pbadlbnlistE1_SHT20 = new
lm_access::BadLBNList();</font></p>
        <p><font face="Courier New, Courier, mono">pbadlbnlistEM_HI_SH-&gt;loadBadLBNs("1EMloose_EM_HI_SH_0-177000.badlbns");</font></p>
        <p><font face="Courier New, Courier, mono">pbadlbnlist1EM_SHT20-&gt;loadBadLBNs("1EMloose_1EMSHT20_177001-199999.badlbns");</font><font
 face="Courier New, Courier, mono"></font> </p>
        <p><font face="Courier New, Courier, mono">// in your event
loop &#8211; cut out the bad lbns<br>
if(run &lt;= 177000 &amp;&amp; pbadlbnlistEM_HI_SH-&gt;isBadLBN(lbn))
continue;</font></p>
        <p><font face="Courier New, Courier, mono">if(run &gt; 177000
&amp;&amp; pbadlbnlist1EM_SHT20-&gt;isBadLBN(lbn)) continue;</font><font
 face="Courier New, Courier, mono"></font> </p>
        <p><font face="Courier New, Courier, mono">// at the end<br>
delete pbadlbnlistEM_HI_SH;</font><br>
        <font face="Courier New, Courier, mono">delete
pbadlbnlistE1_SHT20;</font> </p>
      </blockquote>
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>
